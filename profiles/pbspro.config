process {
    executor       = 'pbspro'

    // Default resources
    queue          = params.hpc_queue
    project        = params.hpc_project
    storage        = params.hpc_storage
    cpus           = params.default_cpus
    memory         = params.default_memory
    time           = params.default_time

    // Per-process overrides
    withName: 'SAMTOOLS_FILTER' {
        cpus       = params.filter_cpus
    }
    withName: 'SAMTOOLS_SORT' {
        cpus       = params.sort_cpus
    }
    withName: 'SAMTOOLS_INDEX' {
        cpus       = params.index_cpus
    }
    withName: 'MODKIT_PILEUP' {
        cpus       = params.pileup_cpus
        memory     = params.pileup_memory
        time       = params.pileup_time
    }
    withName: 'T2G' {
        disk       = params.t2g_disk // Job filesystem space needed
        memory     = params.t2g_memory
    }
}

conda.enabled      = true
